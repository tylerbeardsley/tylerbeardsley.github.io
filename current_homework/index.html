<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="style.css" type="text/css" />
    <script type = "text/javascript"
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAi1XWg6204cWkmi1cHnD9cqzFd1llj1T0">
    </script>
    <script type="text/javascript">
      if(navigator.geolocation){
        var myLat = position.coords.latitude;
        var myLong = position.coords.longitude;}
      else {
        error("Geo Location is not supported");}
      function initialize() {
        var mapOptions = {
          center: { lat: myLat, lng: myLong}, //centered on current position
          zoom: 10
        };
        var map = new google.maps.Map(document.getElementById('map-canvas'),
            mapOptions);
      }
      google.maps.event.addDomListener(window, 'load', initialize);
    </script>
  </head>
  <body>
    <div id="map-canvas"></div>
    <script>
       var myRequest = new XMLHttpRequest();
       var result = "";
       myRequest.open("GET", "http://developer.mbta.com/lib/rthr/red.json", true);
       
       setInterval(function myFunction(), 5000); 
       myRequest.onreadystatechange = myFunction();
       function myFunction{ 
       if(myRequest.readyState == 4 && myRequest.status == 200){  
           data = JSON.parse(myRequest.responseText);
           for(i = 0; i < data.length; i++){
               var latlng = new google.maps.LatLng(data[i]["Lat"], data[i]["Long"]);
               var marker = new google.maps.Marker({position: latlng, map: map});
               marker.setMap(map);
           }
        }
          
       };
       myRequest.send();
    </script>
  </body>
</html>